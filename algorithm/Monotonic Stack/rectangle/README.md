# 二、矩形专题

## 📖 专题介绍

矩形专题是单调栈的重要应用领域，主要解决：
- 柱状图中的最大矩形面积
- 二维矩阵中的最大矩形
- 接雨水问题
- 统计矩形相关问题

## 💡 核心思想

### 1. 柱状图最大矩形
使用单调栈找到每个柱子左右两侧第一个比它矮的柱子，从而确定以该柱子为高的最大矩形宽度。

**公式**: `面积 = 高度 × 宽度`
- 高度：当前柱子的高度
- 宽度：左右边界之间的距离

### 2. 二维矩形
将二维问题转化为多个一维柱状图问题：
- 枚举每一行作为底边
- 将上方连续的 1 累加成柱子高度
- 对每一行应用柱状图算法

### 3. 接雨水
双向扫描或单调栈：
- 找到左右两侧第一个更高的柱子
- 水量由较矮的一侧决定

## 🎯 题目分类

### 基础题型
- **84. 柱状图中最大的矩形** - 经典问题
- **42. 接雨水** - 多种解法

### 矩阵问题
- **85. 最大矩形** - 二维扩展
- **221. 最大正方形** - 正方形约束

### 统计问题
- **1504. 统计全 1 子矩形**
- **1277. 统计全为 1 的正方形子矩阵**

### 进阶应用
- **1793. 好子数组的最大分数**
- **755. 倒水**（会员题）

详见 `problems.md`

## 📐 算法模板

### 柱状图最大矩形模板

```python
def largestRectangleArea(heights: List[int]) -> int:
    n = len(heights)
    left = [0] * n  # left[i] 为左侧第一个小于 heights[i] 的位置
    right = [0] * n  # right[i] 为右侧第一个小于 heights[i] 的位置
    
    # 单调递增栈，找左边界
    st = [-1]
    for i in range(n):
        while len(st) > 1 and heights[st[-1]] >= heights[i]:
            st.pop()
        left[i] = st[-1]
        st.append(i)
    
    # 单调递增栈，找右边界
    st = [n]
    for i in range(n - 1, -1, -1):
        while len(st) > 1 and heights[st[-1]] >= heights[i]:
            st.pop()
        right[i] = st[-1]
        st.append(i)
    
    # 计算最大面积
    max_area = 0
    for i in range(n):
        width = right[i] - left[i] - 1
        max_area = max(max_area, heights[i] * width)
    
    return max_area
```

## 📊 复杂度分析

- **时间复杂度**: O(n) 或 O(mn) (二维问题)
- **空间复杂度**: O(n)

## 💭 学习建议

1. **从一维开始**: 先掌握 84 题的柱状图算法
2. **理解转化**: 学会将二维问题转化为一维
3. **多种解法**: 接雨水问题可以尝试不同解法对比
4. **画图理解**: 矩形问题最好配合图示理解

## 🔗 相关资源

- 回到 [单调栈主页](../README.md)
- 查看 [题目列表](problems.md)
- 继续学习 [贡献法](../contribution/README.md)
