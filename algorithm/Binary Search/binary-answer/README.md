# 二分答案

## 核心思想

> "花费一个 log 的时间,增加了一个条件。" —— 二分答案

**题目求什么，就二分什么。**

## 与数组二分的联系

### 答疑

**问**: 如何把二分答案与数组上的二分查找联系起来？

**答**: 假设答案在区间 [2,5] 中，我们相当于在一个虚拟数组 `[check(2), check(3), check(4), check(5)]` 中二分找第一个（或者最后一个）值为 `true` 的 `check(x)`。这同样可以用红蓝染色法思考。

**问**: 有些题目，明明 m 可以是答案，但却不在初始二分区间中。比如闭区间二分初始化 `right=m−1`（或者开区间 `right=m`），这不会算错吗？

**答**: 不会算错。注意「答案所在区间」和「二分区间」是两个概念。想一想，如果二分的 while 循环每次更新的都是 `left`，那么最终答案是什么？正好就是 `m`。一般地，如果一开始就能确定 `m` 一定可以满足题目要求，那么 `m` 是不需要在二分区间中的。换句话说，二分区间是「尚未确定是否满足题目要求」的数的范围。那些在区间外面的数，都是已确定的满足（不满足）题目要求的数。

**问**: 什么是循环不变量？

**答**: 想一想，对于求最小的题目，开区间二分的写法，为什么最终返回的是 `right`，而不是别的数？在初始化（循环之前）、循环中、循环结束后，都时时刻刻保证 `check(right) == true` 和 `check(left) == false`，这就叫循环不变量。根据循环不变量，循环结束时 `left+1=right`，那么 `right` 就是最小的满足要求的数（因为再 −1 就不满足要求了），所以答案是 `right`。

## 模板对比

### 求最小 vs 求最大

| 特征 | 求最小 | 求最大 |
|------|--------|--------|
| 红蓝分布 | 左红右蓝（不满足｜满足） | 左蓝右红（满足｜不满足） |
| check 为 true 时 | 更新 `right = mid` | 更新 `left = mid` |
| 最终返回 | `right` | `left` |
| 类比数组二分 | 找第一个满足的 | 找最后一个满足的 |

**开区间写法记忆**：check 更新的是谁，最终就返回谁。

## 子专题

### §2.1 求最小
二分答案求最小值，`check(mid)` 为 true 时更新 `right`。

### §2.2 求最大
二分答案求最大值，`check(mid)` 为 true 时更新 `left`。

### §2.3 二分间接值
二分的不是答案，而是一个和答案有关的值。

### §2.4 最小化最大值
用一个盖子（上界）去压住最大值，看看能否压住。

### §2.5 最大化最小值
提升下界，看看能否满足条件。

### §2.6 第 K 小/大
- 第 k 小 = 求最小的 x，满足 ≤x 的数至少有 k 个
- 第 k 大 = 求最大的 x，满足 ≥x 的数至少有 k 个

## 二分边界优化

部分题目可以优化二分边界，减少二分次数。对于初学者，设定一个比较大的二分上界也是可以的，不必强求最优。

## 学习建议

1. **理解 check 函数**：这是二分答案的核心
2. **区分求最小和求最大**：注意写法的区别
3. **注意循环不变量**：理解为什么这样返回
4. **结合贪心练习**：很多 check 函数需要贪心思想

## 关联题单

二分答案的一个难点是 check 函数怎么写，这会涉及到贪心等技巧。

---

**返回**: [二分查找专题](../README.md)
