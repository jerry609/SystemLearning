# Â§2.6 ç¬¬ K å°/å¤§ - é¢˜ç›®åˆ—è¡¨

> æ³¨ï¼šéƒ¨åˆ†é¢˜ç›®ä¹Ÿå¯ä»¥ç”¨å †è§£å†³

## é¢˜ç›®åˆ—è¡¨

| é¢˜å· | é¢˜ç›® | éš¾åº¦ | éš¾åº¦åˆ† | è¯´æ˜ |
|------|------|------|--------|------|
| 668 | [ä¹˜æ³•è¡¨ä¸­ç¬¬ K å°çš„æ•°](https://leetcode.cn/problems/kth-smallest-number-in-multiplication-table/) | ğŸ”´ å›°éš¾ | - | äºŒåˆ†+æ•°å­¦ |
| 378 | [æœ‰åºçŸ©é˜µä¸­ç¬¬ K å°çš„å…ƒç´ ](https://leetcode.cn/problems/kth-smallest-element-in-a-sorted-matrix/) | ğŸŸ  ä¸­ç­‰ | - | äºŒåˆ†+åŒæŒ‡é’ˆ |
| 719 | [æ‰¾å‡ºç¬¬ K å°çš„æ•°å¯¹è·ç¦»](https://leetcode.cn/problems/find-k-th-smallest-pair-distance/) | ğŸ”´ å›°éš¾ | - | æ’åº+äºŒåˆ†+åŒæŒ‡é’ˆ |
| 878 | [ç¬¬ N ä¸ªç¥å¥‡æ•°å­—](https://leetcode.cn/problems/nth-magical-number/) | ğŸ”´ å›°éš¾ | 1897 | å®¹æ–¥åŸç†+äºŒåˆ† |
| 1201 | [ä¸‘æ•° III](https://leetcode.cn/problems/ugly-number-iii/) | ğŸŸ  ä¸­ç­‰ | 2039 | å®¹æ–¥åŸç†+äºŒåˆ† |
| 793 | [é˜¶ä¹˜å‡½æ•°å K ä¸ªé›¶](https://leetcode.cn/problems/preimage-size-of-factorial-zeroes-function/) | ğŸ”´ å›°éš¾ | 2100 | äºŒåˆ†+æ•°å­¦ |
| 373 | [æŸ¥æ‰¾å’Œæœ€å°çš„ K å¯¹æ•°å­—](https://leetcode.cn/problems/find-k-pairs-with-smallest-sums/) | ğŸŸ  ä¸­ç­‰ | - | å †/äºŒåˆ† |
| 1439 | [æœ‰åºçŸ©é˜µä¸­çš„ç¬¬ k ä¸ªæœ€å°æ•°ç»„å’Œ](https://leetcode.cn/problems/find-the-kth-smallest-sum-of-a-matrix-with-sorted-rows/) | ğŸ”´ å›°éš¾ | 2134 | äºŒåˆ†+è´ªå¿ƒ |
| 786 | [ç¬¬ K ä¸ªæœ€å°çš„è´¨æ•°åˆ†æ•°](https://leetcode.cn/problems/k-th-smallest-prime-fraction/) | ğŸŸ  ä¸­ç­‰ | 2169 | äºŒåˆ†+åŒæŒ‡é’ˆ |
| 3116 | [å•é¢å€¼ç»„åˆçš„ç¬¬ K å°é‡‘é¢](https://leetcode.cn/problems/kth-smallest-amount-with-single-denomination-combination/) | ğŸ”´ å›°éš¾ | 2387 | å®¹æ–¥+äºŒåˆ† |
| 3134 | [æ‰¾å‡ºå”¯ä¸€æ€§æ•°ç»„çš„ä¸­ä½æ•°](https://leetcode.cn/problems/find-the-median-of-the-uniqueness-array/) | ğŸ”´ å›°éš¾ | 2451 | äºŒåˆ†+æ»‘çª— |
| 2040 | [ä¸¤ä¸ªæœ‰åºæ•°ç»„çš„ç¬¬ K å°ä¹˜ç§¯](https://leetcode.cn/problems/kth-smallest-product-of-two-sorted-arrays/) | ğŸ”´ å›°éš¾ | 2518 | äºŒåˆ†+åŒæŒ‡é’ˆ |
| 2386 | [æ‰¾å‡ºæ•°ç»„çš„ç¬¬ K å¤§å’Œ](https://leetcode.cn/problems/find-the-k-sum-of-an-array/) | ğŸ”´ å›°éš¾ | 2648 | **è½¬åŒ–é—®é¢˜** |
| 1508 | [å­æ•°ç»„å’Œæ’åºåçš„åŒºé—´å’Œ](https://leetcode.cn/problems/range-sum-of-sorted-subarray-sums/) | ğŸŸ  ä¸­ç­‰ | - | äºŒåˆ†/æš´åŠ› |
| 3691 | [æœ€å¤§å­æ•°ç»„æ€»å€¼ II](https://leetcode.cn/problems/maximum-subarray-sum-ii/) | ğŸ”´ å›°éš¾ | - | **åšåˆ°æ—¶é—´å¤æ‚åº¦ä¸ k æ— å…³** |
| 3520 | [é€†åºå¯¹è®¡æ•°çš„æœ€å°é˜ˆå€¼](https://leetcode.cn/problems/minimum-threshold-for-inversions-count/)ğŸ”’ | ğŸ”´ å›°éš¾ | - | **ä¼šå‘˜é¢˜** |
| 1918 | [ç¬¬ K å°çš„å­æ•°ç»„å’Œ](https://leetcode.cn/problems/kth-smallest-subarray-sum/)ğŸ”’ | ğŸŸ  ä¸­ç­‰ | - | **ä¼šå‘˜é¢˜** |

## é‡ç‚¹é¢˜ç›®è¯¦è§£

### â­ 668. ä¹˜æ³•è¡¨ä¸­ç¬¬ K å°çš„æ•°

**é¢˜æ„**: m Ã— n çš„ä¹˜æ³•è¡¨ï¼Œæ±‚ç¬¬ k å°çš„æ•°ã€‚

**æ ¸å¿ƒæ€è·¯**:
```python
def check(x):
    # ç»Ÿè®¡ä¹˜æ³•è¡¨ä¸­ <= x çš„æ•°æœ‰å¤šå°‘ä¸ª
    count = 0
    for i in range(1, m + 1):
        # ç¬¬ i è¡Œï¼ši, 2i, 3i, ..., n*i
        # <= x çš„ä¸ªæ•°ï¼šmin(x // i, n)
        count += min(x // i, n)
    return count >= k

# äºŒåˆ† xï¼š[1, m * n]
```

**å…³é”®ç‚¹**:
- ç¬¬ i è¡Œçš„æ•°éƒ½æ˜¯ i çš„å€æ•°
- ç¬¬ i è¡Œ <= x çš„ä¸ªæ•°æ˜¯ `min(x // i, n)`

### â­ 378. æœ‰åºçŸ©é˜µä¸­ç¬¬ K å°çš„å…ƒç´ 

**é¢˜æ„**: æ¯è¡Œæ¯åˆ—éƒ½é€’å¢çš„çŸ©é˜µï¼Œæ±‚ç¬¬ k å°çš„å…ƒç´ ã€‚

**æ ¸å¿ƒæ€è·¯**:
```python
def check(x):
    # ç»Ÿè®¡ <= x çš„å…ƒç´ ä¸ªæ•°
    # ä»å·¦ä¸‹è§’å¼€å§‹ï¼Œå‘å³ä¸Šç§»åŠ¨
    count = 0
    row, col = n - 1, 0
    
    while row >= 0 and col < n:
        if matrix[row][col] <= x:
            count += row + 1  # è¿™ä¸€åˆ—å‰ row+1 ä¸ªéƒ½ <= x
            col += 1
        else:
            row -= 1
    
    return count >= k

# äºŒåˆ† xï¼š[matrix[0][0], matrix[n-1][n-1]]
```

**å…³é”®ç‚¹**:
- ä»å·¦ä¸‹è§’å¼€å§‹éå†
- åˆ©ç”¨è¡Œåˆ—çš„å•è°ƒæ€§

### â­ 719. æ‰¾å‡ºç¬¬ K å°çš„æ•°å¯¹è·ç¦»

**é¢˜æ„**: æ•°ç»„ä¸­æ‰€æœ‰æ•°å¯¹çš„è·ç¦»ï¼ˆç»å¯¹å€¼å·®ï¼‰ï¼Œæ±‚ç¬¬ k å°çš„è·ç¦»ã€‚

**æ ¸å¿ƒæ€è·¯**:
```python
def check(dist):
    # ç»Ÿè®¡è·ç¦» <= dist çš„æ•°å¯¹ä¸ªæ•°
    # æ’åºåç”¨åŒæŒ‡é’ˆ
    count = 0
    left = 0
    
    for right in range(len(nums)):
        while nums[right] - nums[left] > dist:
            left += 1
        count += right - left  # [left, right) éƒ½å¯ä»¥å’Œ right é…å¯¹
    
    return count >= k

# å…ˆæ’åº
nums.sort()
# äºŒåˆ†è·ç¦»ï¼š[0, max(nums) - min(nums)]
```

**å…³é”®ç‚¹**:
- å…ˆæ’åº
- åŒæŒ‡é’ˆç»Ÿè®¡è·ç¦» <= dist çš„æ•°å¯¹

### â­ 878. ç¬¬ N ä¸ªç¥å¥‡æ•°å­—

**é¢˜æ„**: ç¥å¥‡æ•°å­—æ˜¯èƒ½è¢« a æˆ– b æ•´é™¤çš„æ•°ï¼Œæ±‚ç¬¬ n ä¸ªç¥å¥‡æ•°å­—ã€‚

**æ ¸å¿ƒæ€è·¯**:
```python
def check(x):
    # ç»Ÿè®¡ <= x çš„ç¥å¥‡æ•°å­—ä¸ªæ•°
    # å®¹æ–¥åŸç†ï¼š|AâˆªB| = |A| + |B| - |Aâˆ©B|
    lcm_ab = a * b // gcd(a, b)
    count = x // a + x // b - x // lcm_ab
    return count >= n

# äºŒåˆ† xï¼š[1, min(a,b) * n]
```

**å…³é”®ç‚¹**:
- å®¹æ–¥åŸç†ç»Ÿè®¡ä¸ªæ•°
- æ³¨æ„æœ€å°å…¬å€æ•°

### â­ 1201. ä¸‘æ•° III

**é¢˜æ„**: ä¸‘æ•°æ˜¯èƒ½è¢« aã€b æˆ– c æ•´é™¤çš„æ•°ï¼Œæ±‚ç¬¬ n ä¸ªä¸‘æ•°ã€‚

**æ ¸å¿ƒæ€è·¯**:
```python
def check(x):
    # ä¸‰ä¸ªé›†åˆçš„å®¹æ–¥åŸç†
    # |AâˆªBâˆªC| = |A| + |B| + |C| - |Aâˆ©B| - |Aâˆ©C| - |Bâˆ©C| + |Aâˆ©Bâˆ©C|
    lcm_ab = a * b // gcd(a, b)
    lcm_ac = a * c // gcd(a, c)
    lcm_bc = b * c // gcd(b, c)
    lcm_abc = a * lcm_bc // gcd(a, lcm_bc)
    
    count = (x // a + x // b + x // c 
             - x // lcm_ab - x // lcm_ac - x // lcm_bc 
             + x // lcm_abc)
    return count >= n
```

**å…³é”®ç‚¹**:
- ä¸‰ä¸ªé›†åˆçš„å®¹æ–¥åŸç†
- è®¡ç®—æœ€å°å…¬å€æ•°æ—¶æ³¨æ„é¡ºåº

### â­ 2386. æ‰¾å‡ºæ•°ç»„çš„ç¬¬ K å¤§å’Œ

**é¢˜æ„**: æ‰€æœ‰éç©ºå­åºåˆ—çš„å’Œï¼Œæ±‚ç¬¬ k å¤§çš„å’Œã€‚

**æ ¸å¿ƒæ€è·¯**:
```python
# è½¬åŒ–ï¼šç¬¬ k å¤§å’Œ = æ€»å’Œ - ç¬¬ k å°çš„åˆ é™¤å’Œ
# é—®é¢˜è½¬åŒ–ä¸ºï¼šé€‰æ‹©ä¸€äº›è´Ÿæ•°ï¼ˆä¸é€‰æ­£æ•°ï¼‰ï¼Œæ±‚ç¬¬ k å°çš„ç»å¯¹å€¼å’Œ

def check(x):
    # ç»Ÿè®¡ç»å¯¹å€¼å’Œ <= x çš„åˆ é™¤æ–¹æ¡ˆæ•°
    # ç”¨å †æˆ– DP
    pass

# æŠŠæ‰€æœ‰è´Ÿæ•°å˜æˆæ­£æ•°çš„ç»å¯¹å€¼
# äºŒåˆ†ç¬¬ k å°çš„åˆ é™¤å’Œ
# ç­”æ¡ˆ = æ€»å’Œ - ç¬¬ k å°åˆ é™¤å’Œ
```

**å…³é”®ç‚¹**:
- å·§å¦™è½¬åŒ–é—®é¢˜
- ç¬¬ k å¤§ = æ€»å’Œ - ç¬¬ k å°åˆ é™¤

## é¢˜ç›®åˆ†ç±»

### 1. è§„åˆ™çŸ©é˜µ/è¡¨æ ¼ï¼ˆ3é¢˜ï¼‰

åœ¨æœ‰è§„å¾‹çš„çŸ©é˜µä¸­æ‰¾ç¬¬ k å°ï¼š
- 668ï¼ˆä¹˜æ³•è¡¨ï¼‰
- 378ï¼ˆæœ‰åºçŸ©é˜µï¼‰
- 1439ï¼ˆçŸ©é˜µè¡Œå’Œï¼‰

**æ ¸å¿ƒ**: åˆ©ç”¨çŸ©é˜µçš„è§„å¾‹å¿«é€Ÿç»Ÿè®¡

### 2. è·ç¦»/å·®å€¼ï¼ˆ2é¢˜ï¼‰

æ•°å¯¹ä¹‹é—´çš„è·ç¦»ï¼š
- 719ï¼ˆæ•°å¯¹è·ç¦»ï¼‰
- 786ï¼ˆè´¨æ•°åˆ†æ•°ï¼‰

**æ ¸å¿ƒ**: æ’åº + åŒæŒ‡é’ˆç»Ÿè®¡

### 3. å®¹æ–¥åŸç†ï¼ˆ3é¢˜ï¼‰

å¤šä¸ªé›†åˆçš„å¹¶é›†ï¼š
- 878ï¼ˆç¬¬ n ä¸ªç¥å¥‡æ•°ï¼‰
- 1201ï¼ˆä¸‘æ•° IIIï¼‰
- 3116ï¼ˆå•é¢å€¼ç»„åˆï¼‰

**æ ¸å¿ƒ**: å®¹æ–¥åŸç†ç»Ÿè®¡ä¸ªæ•°

### 4. å¤æ‚é—®é¢˜è½¬åŒ–ï¼ˆ4é¢˜ï¼‰

éœ€è¦è½¬åŒ–æˆ–ç‰¹æ®ŠæŠ€å·§ï¼š
- 2040ï¼ˆä¹˜ç§¯ï¼‰
- 2386ï¼ˆè½¬åŒ–ï¼‰
- 3134ï¼ˆä¸­ä½æ•°ï¼‰
- 3691ï¼ˆå­æ•°ç»„ï¼‰

## Check å‡½æ•°æ¨¡å¼

### æ¨¡å¼1: æ•°å­¦å…¬å¼

```python
def check(x):
    # ç›´æ¥ç”¨æ•°å­¦å…¬å¼ç»Ÿè®¡ <= x çš„ä¸ªæ•°
    count = x // a + x // b - x // lcm_ab
    return count >= k
```

### æ¨¡å¼2: åŒæŒ‡é’ˆ

```python
def check(x):
    # æ’åºåç”¨åŒæŒ‡é’ˆç»Ÿè®¡
    count = 0
    left = 0
    for right in range(n):
        while condition(left, right, x):
            left += 1
        count += right - left
    return count >= k
```

### æ¨¡å¼3: éå†è®¡ç®—

```python
def check(x):
    # éå†æ¯ä¸€è¡Œ/æ¯ä¸ªå…ƒç´ 
    count = 0
    for i in range(n):
        count += calculate(i, x)
    return count >= k
```

## å¸¸è§æŠ€å·§

### æŠ€å·§1: å®¹æ–¥åŸç†

```python
# ä¸¤ä¸ªé›†åˆ
count = x // a + x // b - x // lcm(a, b)

# ä¸‰ä¸ªé›†åˆ
count = (x // a + x // b + x // c
         - x // lcm(a,b) - x // lcm(a,c) - x // lcm(b,c)
         + x // lcm(a,b,c))
```

### æŠ€å·§2: æœ€å°å…¬å€æ•°

```python
def gcd(a, b):
    while b:
        a, b = b, a % b
    return a

def lcm(a, b):
    return a * b // gcd(a, b)
```

### æŠ€å·§3: æœ‰åºçŸ©é˜µéå†

```python
# ä»å·¦ä¸‹è§’å¼€å§‹
row, col = n - 1, 0
while row >= 0 and col < n:
    if matrix[row][col] <= target:
        # è¿™ä¸€åˆ—çš„å‰ row+1 ä¸ªéƒ½æ»¡è¶³
        count += row + 1
        col += 1
    else:
        row -= 1
```

## ç»ƒä¹ å»ºè®®

1. **ç†è§£å®šä¹‰**ï¼šç¬¬ k å° = æœ€å°çš„ xï¼Œâ‰¤x çš„æ•°æœ‰ k ä¸ª
2. **æŒæ¡ç»Ÿè®¡**ï¼šå¿«é€Ÿç»Ÿè®¡ â‰¤x çš„ä¸ªæ•°æ˜¯å…³é”®
3. **å­¦ä¼šè½¬åŒ–**ï¼šæœ‰äº›é—®é¢˜éœ€è¦è½¬åŒ–æ‰èƒ½äºŒåˆ†
4. **å¯¹æ¯”å †è§£æ³•**ï¼šç†è§£äºŒåˆ†å’Œå †çš„ä¼˜åŠ£

## å¸¸è§é”™è¯¯

1. âŒ k ä» 0 å¼€å§‹ï¼ˆåº”è¯¥ä» 1 å¼€å§‹ï¼‰
2. âŒ ç»Ÿè®¡ä¸ªæ•°æ—¶é‡å¤æˆ–é—æ¼
3. âŒ å®¹æ–¥åŸç†å…¬å¼é”™è¯¯
4. âŒ æœ€å°å…¬å€æ•°è®¡ç®—æº¢å‡º

---

**è¿”å›**: [ç¬¬Kå°/å¤§](README.md) | [äºŒåˆ†ç­”æ¡ˆ](../README.md)
